<div class="container">
    <div class="search-bar">
      <input type="text" placeholder="Search artist" [(ngModel)]="searchTerm" (keyup)="search()"/>
      <div class="radio-buttons">
        <label><input type="radio" name="searchType" value="artist" checked> Artist</label>
        <label><input type="radio" name="searchType" value="album"> Album</label>
        <label><input type="radio" name="searchType" value="track"> Track</label>
      </div>
    </div>
    <div class="tables-wrapper">
      <cdk-virtual-scroll-viewport itemSize = "48" class="scrollable-table">
        <table>
          <thead>
            <tr>
              <th>Select</th>
              <th>Artist</th>
              <th>Scrobbles</th>
            </tr>
          </thead>
          <tbody>
            <!-- Repeated table rows will be generated by Angular *ngFor directive -->
            <tr *cdkVirtualFor="let artist of filteredArtists" draggable="true" (dragstart)="onDragStart($event, artist.name)">
              <td>{{ artist.name }}</td>
              <td>{{ artist.scrobbles }}</td>
            </tr>
          </tbody>
        </table>
      </cdk-virtual-scroll-viewport>
      <!--<cdk-virtual-scroll-viewport itemSize="48" class="selected-table">
        <table>
          <thead>
            <tr>
              <th>Artist</th>
            </tr>
          </thead>
          <tbody>
            <tr *cdkVirtualFor="let artist of selectedArtists">
              <td><button (click)="onRemoveClick(artist)"></button></td>
              <td>{{ artist.name }}</td>
            </tr>
          </tbody>
        </table>
      </cdk-virtual-scroll-viewport>-->
      <div class="combinations-table">
          <table>
            <thead>
              <tr>
                <th>Combinations</th>
                <button (click)="addNewCombo()">Add New Combination</button>
              </tr>
            </thead>
            <tbody>
              <ng-container *ngFor="let combo of combinations">
                  <!-- Combination Row -->
                  <tr (click)="toggleChildren(combo)" (dragover)="onDragOver($event)" (drop)="onDrop($event, combo)">
                    <td>
                      <div *ngIf="!combo.isEditing; else editComboNameTemplate" (dblclick)="editComboName(combo)">
                        {{ combo.name || 'New Combination'}}
                      </div>
                      <ng-template #editComboNameTemplate>
                        <input class="combo-name-input" [(ngModel)]="combo.name"
                          (blur)="updateComboName($event, combo)" (keyup.enter)="updateComboName($event, combo)"
                          #comboNameInput/>
                      </ng-template>
                    </td>
                    <td>
                      <button (click)="deleteCombo(combo)">X</button>
                    </td>
                  </tr>
                  <!-- Artist Rows (conditionally displayed) -->
                  <ng-container *ngIf="combo.childrenVisible">
                    <tr *ngFor="let artistName of combo.artists" draggable="true" (dragstart)="onDragStartBtwnCombos($event, artistName, combo)" 
                      (dragover)="onDragOver($event)" (drop)="onDrop($event, combo)">
                      <td style="padding-left: 40px;">{{ artistName }}</td>
                      <td>
                        <button (click)="deleteArtistFromCombo(artistName, combo)">X</button>
                      </td>
                    </tr>
                  </ng-container>
                </ng-container>
            </tbody>
          </table>
      </div>
    </div>
    <input type="text" placeholder="Enter New Artist Name" [(ngModel)]="newArtistName">
    <!--<button (click)="combineSelected()">Combine Selected Artists</button>-->
    <button (click)="submitCombos()">Submit Combined Artists</button>
  </div>
  